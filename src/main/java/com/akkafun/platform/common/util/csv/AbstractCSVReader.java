package com.akkafun.platform.common.util.csv;import java.io.BufferedReader;import java.io.IOException;import java.io.InputStream;import java.io.InputStreamReader;import java.io.UnsupportedEncodingException;import org.slf4j.Logger;import org.slf4j.LoggerFactory;/** *  * @author liubin * */public abstract class AbstractCSVReader {	protected final Logger logger = LoggerFactory.getLogger(this.getClass());		// 标题	protected String[] titles = null;		/**	 * 每处理完一行后具体逻辑实现方法	 * @param rowData 行数据	 * @param rowIndex 行号	 */	public abstract void afterRow(String[] rowData, int rowIndex);		/**	 * 读取内容	 * @param in 输入流	 * @param startRow 开始行	 * @param startCell 开始列	 * @param cellCount 列数	 */	public void read(InputStream in, int startRow, int startCell, int cellCount) {		BufferedReader reader = null;		try {			reader = new BufferedReader(new InputStreamReader(in, "GBK"));		} catch (UnsupportedEncodingException e) {			logger.error("", e);		}		int rowIndex = 0;		try {			String rowStr = null;			while((rowStr = reader.readLine()) != null) {				rowStr = rowStr.trim();				if(rowStr.endsWith(",")) {					rowStr = rowStr + " ";				}				String[] rowData = rowStr.split(",");				if(rowIndex == 0){					if(startCell >= rowData.length) {						throw new RuntimeException("开始列大于总列数");					}					if(cellCount == 0 || cellCount > rowData.length - startCell) {						cellCount = rowData.length - startCell;					}					titles = new String[cellCount];					System.arraycopy(rowData, startCell, titles, 0, cellCount);				}				if(rowIndex >= startRow) {					String[] data= new String[cellCount];					System.arraycopy(rowData, startCell, data, 0, cellCount);					afterRow(data, rowIndex);				}				rowIndex++;			}		} catch (IOException e) {			logger.error("", e);		} finally {			try {				if(reader != null) {					reader.close();				}			} catch (IOException e) {				logger.error("", e);			}		}			}}