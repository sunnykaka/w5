package com.akkafun.platform.common.util.csv;import java.io.BufferedWriter;import java.io.IOException;import java.io.OutputStream;import java.io.OutputStreamWriter;import java.io.UnsupportedEncodingException;import org.slf4j.Logger;import org.slf4j.LoggerFactory;/** *  * @author liubin * */public class CSVCreator {	// 日志	protected final Logger logger = LoggerFactory.getLogger(this.getClass());		// 输出	protected BufferedWriter writer;		/**	 * 构造方法	 * @param os csv的输出流	 */	public CSVCreator(OutputStream os) {		writer = new BufferedWriter(new OutputStreamWriter(os));	}		/**	 * 根据指定字符集构造	 * @param os	 * @param charsetName	 */	public CSVCreator(OutputStream os, String charsetName) {		try {			writer = new BufferedWriter(new OutputStreamWriter(os, charsetName));		} catch (UnsupportedEncodingException e) {			logger.error("", e);		}	}		/**	 * 创建一行	 * @param rowData 行数据	 */	public void addRow(String[] rowData) {		StringBuilder sb = new StringBuilder();		for(String data : rowData) {			sb.append(data);			sb.append(",");		}		sb.deleteCharAt(sb.length() - 1);		try {			writer.append(sb);			writer.newLine();		} catch (IOException e) {			logger.error("", e);		}	}		/**	 * 关闭输出流,执行写入文件操作	 */	public void close() {		try {			if(writer != null) {				writer.close();			}		} catch (IOException e) {			logger.error("", e);		} 	}}